<script>
        function Device(power) {
        this._power = power;
        this._enabled=false
        var self=this

    }
    
    Device.prototype.enable = function() {
        self._enabled = true;
    }
    ;
    Device.prototype.disable = function() {
        self._enabled = false;
    }
    ;
    function CoffeeMachine(power, capacity) {
        Device.apply(this, arguments);
        this._capacity = capacity;
        this._waterAmount;
        var timerId;
    }
    CoffeeMachine.prototype = Object.create(Device.prototype)
    CoffeeMachine.prototype.constructor = CoffeeMachine;
    
    Device.prototype._powerValid = function(power) {
        if (typeof power === 'number') {
            this._power = power;
        }
    }
    Device.prototype.setPower = function(power) {
        Device.prototype._powerValid(power)
    }
   
    CoffeeMachine.prototype._wateramountValid = function(amount) {
        if (typeof amount === 'number' && amount > 0 && amount < this._capacity) {
           this._waterAmount = amount
        }
    }

    CoffeeMachine.prototype.setWaterAmount = function(amount) {
        if (amount < 0) {
            throw new Error("Значение должно быть положительным");
        }
        if (amount > this._capacity) {
            throw new Error("Нельзя залить больше, чем " + capacity);
        }
        this._wateramountValid(amount)
    }
    CoffeeMachine.prototype.disable = function() {
        Device.prototype.disable()
        clearTimeout(this.timerId)
        alert('Кофеварка остановлена')
    }
    CoffeeMachine.prototype._onReady = function() {
        alert('Кофе готов!')
    }
    CoffeeMachine.prototype.run = function() {
        if (!self._enabled) {
            throw new Error("Кофеварка выключена")
        }
        timerId = setTimeout(this._onReady, 1000)
    }
    CoffeeMachine.prototype.addWater = function(amount) {
        this.setWaterAmount(this._waterAmount + amount);
    }
    ;
    function Fridge(power) {
        Device.apply(this, arguments)
        this._food = [];
    }
    Fridge.prototype = Object.create(Device.prototype)
    Fridge.prototype.constructor = Fridge;
    Fridge.prototype.addFood = function() {
        for (var i = 0; i < arguments.length; i++) {
            this._food.push(arguments[i])
        }
        if (!self._enabled) {
            throw new Error("Холодильник выключен");
        }
        if (this._food.length + arguments.length > this._power / 100) {
            throw new Error("Нельзя добавить, не хватает мощности");
        }
    }
    Fridge.prototype._getFood = function() {
        var res = 'В холодильнике: ' + this._food
        return res;
    }

    function Light(power) {
        Device.apply(this, arguments)
        if (this._enabled) {
            alert('Свет выключен')
        } else {
            alert('Свет включен на мощности :' + this._power)
        }
    }

    Light.prototype = Object.create(Device.prototype)
    Light.prototype.constructor = Light;
    function Microwave(power) {
        Device.apply(this, arguments)
    }
    Microwave.prototype = Object.create(Device.prototype)
    Microwave.prototype.constructor = Microwave;
    Microwave.prototype._onReady = function() {
        alert('Еда нагрета');
    }
    Microwave.prototype._getTimeToCook = function() {
        var time = prompt('Установите время для подогрева', '');
        return time
    }
    Microwave.prototype.run = function() {
        if (!self._enabled) {
            throw new Error("Микроволновка выключена");
        }
        timerId = setTimeout(this._onReady, Microwave.prototype._getTimeToCook());
    }
    ;
    Microwave.disable = function() {
        Device.disable();
        clearTimeout(this.timerId);
        alert('Микроволновка остановлена')
    }

    var coffeeMachine = new CoffeeMachine(100000,400);
    coffeeMachine.enable();
    coffeeMachine.setPower(1000)
    coffeeMachine.setWaterAmount(100);
    coffeeMachine.addWater(200);
    coffeeMachine.addWater(100);
    //coffeeMachine.disable();-остановит кофеварку
    //coffeeMachine.addWater(300); // Нельзя залить больше..
    coffeeMachine.run();
    var fridge = new Fridge(500);

    fridge.setPower(1000);
    //fridge.enable();
    fridge.addFood("котлета");
    fridge.addFood("сок", "варенье");
    fridge.addFood("торт");
    fridge.disable()
    alert(fridge._getFood());
    var light = new Light(100);
    light.enable();
    light.setPower(180);
    light.enable();
    var microwave = new Microwave(300);
    microwave.enable();
    microwave.run();
</script>
